name: Release Dispatcher (Sync)

on:
  push:
    branches:
      - "**"

jobs:
  dispatch-sync:
    # åªæœ‰æäº¤ä¿¡æ¯åŒ…å« [deploy-sync] æ—¶æ‰è¿è¡Œ
    if: contains(github.event.head_commit.message, '[deploy-sync]')
    runs-on: ubuntu-latest
    permissions:
      actions: write  # éœ€è¦æƒé™è§¦å‘å…¶ä»–å·¥ä½œæµ
    steps:
      - name: Trigger Alpha & Beta Builds
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "ğŸš€ æ£€æµ‹åˆ°åŒæ­¥å‘ç‰ˆæŒ‡ä»¤ï¼Œæ­£åœ¨è§¦å‘ Alpha å’Œ Beta æ„å»º..."
          
          # 1. è§¦å‘ Alpha (å†…æµ‹ç‰ˆ)
          # --ref æŒ‡å®šä½¿ç”¨å½“å‰è§¦å‘çš„åˆ†æ”¯
          gh workflow run install.yml --repo ${{ github.repository }} --ref ${{ github.ref }} -f deploy_alpha=true
          echo "âœ… Alpha ç‰ˆæ„å»ºè¯·æ±‚å·²å‘é€"
          
          # 2. è§¦å‘ Beta (å…¬æµ‹ç‰ˆ)
          gh workflow run install.yml --repo ${{ github.repository }} --ref ${{ github.ref }} -f deploy_beta=true
          echo "âœ… Beta ç‰ˆæ„å»ºè¯·æ±‚å·²å‘é€"